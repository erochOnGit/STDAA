/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var u=Object.defineProperty;var g=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var h=(n,r)=>{for(var e in r)u(n,e,{get:r[e],enumerable:!0})},E=(n,r,e,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let t of m(r))!p.call(n,t)&&t!==e&&u(n,t,{get:()=>r[t],enumerable:!(o=g(r,t))||o.enumerable});return n};var T=n=>E(u({},"__esModule",{value:!0}),n);var w={};h(w,{default:()=>c});module.exports=T(w);var d=require("obsidian"),c=class extends d.Plugin{constructor(){super(...arguments);this.cursorPos=null}async onload(){console.log("format on drop unable"),this.registerDomEvent(document,"dragover",e=>{let o=e.target,t=this.getEditorFromTarget(o);if(t){let a=t.cm,{clientX:l,clientY:s}=e;if(!t.containerEl)return null;let f=a.posAtCoords({x:l,y:s});t.focus(),this.cursorPos=t.offsetToPos(f)}}),this.registerDomEvent(document,"drop",e=>{var a;e.preventDefault(),e.stopImmediatePropagation();let o=e.target,t=(a=e.dataTransfer)==null?void 0:a.getData("text");if(t){let l=this.formatDroppedText(t),s=this.getEditorFromTarget(o);if(s){let i={line:0,ch:0};this.cursorPos?i=this.cursorPos:i=s.getCursor(),s.replaceRange(l,i),setTimeout(()=>{s.focus(),s.setCursor({line:i.line,ch:i.ch+l.length})},500)}else console.warn("No editor found for target element.")}else console.warn("No text found in drop event.")},!0)}onunload(){console.log("Plugin unloaded")}getEditorFromTarget(e){for(let o of this.app.workspace.getLeavesOfType("markdown")){let t=o.view;console.log(t);let a=t.editor;if(t.containerEl.contains(e))return a}return null}formatDroppedText(e){if(e.startsWith("obsidian://open?vault="))try{let o=new URL(e);return`![Image](${decodeURIComponent(o.searchParams.get("file")||"")})`}catch(o){return console.error("Error parsing dropped text:",o),e}return e}};
